<!DOCTYPE html>
<!-- saved from url=(0067)http://scop.test.yijiupidev.com/templates/index.html#/inventoryList -->
<html lang="zh-cn"><!--<![endif]--><!-- BEGIN HEAD -->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>生成出库单</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <!-- BEGIN GLOBAL MANDATORY STYLES -->
    <link href="../weiyebancai/font-opensans.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/simple-line-icons.min.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/bootstrap.fileinput.min.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/uniform.default.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/bootstrap-switch.min.css" rel="stylesheet" type="text/css">

    <link href="../weiyebancai/angular-block-ui.min.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/angular-toastr.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/select.min.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/select.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/selectize.default.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/select2.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/select2-bootstrap.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/components-rounded.css" id="style_components" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/plugins.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/weui.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/custom.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/layout.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/darkblue.css" rel="stylesheet" type="text/css" id="style_color">
    <link href="../weiyebancai/custom(1).css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/SelectSearch.css" rel="stylesheet" type="text/css">
    <link href="../weiyebancai/add-picture.css" rel="stylesheet" type="text/css">
    <script src="../../js/jquery-2.1.0.js"></script>
    <script src="../../js/bootstrap.min.css"></script>
    <script src="../../js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../../css/loader.css">
    <script type="text/javascript">
        // 等待所有加载
        $(window).load(function () {
            $('body').addClass('loaded');
            $('#loader-wrapper .load_title').remove();
            $('.datepicker').datepicker();
        });
    </script>
</head>
<!-- END HEAD -->
<!-- BEGIN BODY -->
<body class="page-header-fixed page-style-square ng-scope block-ui block-ui-anim-fade"
      aria-busy="false" onload="bodyonloadOrder(this)">
<div id="loader-wrapper">
    <div id="loader"></div>
    <div class="loader-section section-left"></div>
    <div class="loader-section section-right"></div>
    <div class="load_title">正在拼命加载中<br><span></span></div>
</div>


<div class="page-content-wrapper">
    <div class="page-content" id="dataLoading" style="min-height:813px">
        <div data-ui-view="" class="fade-in-up ng-scope">
            <div data-page-top="">
                <h3 class="page-title ng-binding" data-ng-bind="$state.current.data.pageTitle">出库单查询</h3>
            </div>
            <div class="row" data-page-content="">
                <div class="col-md-12">
                    <div class="portlet light bordered">
                        <div class=" portlet-title">
                            <div class=" caption " data-ng-hide="$state.current.data.captionHelper">
                                <span class=" caption-subject font-green-sharp bold uppercase"> 搜索 </span>&nbsp;
                                <span class=" caption-helper"> 输入搜索信息 </span>
                            </div>
                            <!-- ngIf: $state.current.data.captionHelper -->
                        </div>
                        <div class="portlet-body" data-ng-transclude="">
                            <form onkeydown="if(event.keyCode==13){return false;}"
                                  class="form-horizontal data-ng-pristine data-ng-valid searchbox ng-pristine ng-valid"
                                  data-page-search="">
                                <div class="form-body" data-ng-transclude="">
                                    <div class="row ng-scope">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="col-md-3 control-label">订单号：</label>
                                                <div class="col-md-9">
                                                    <input type="text" name="product_name"
                                                           class="form-control "
                                                           placehold="产品名称" id="noteno">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="col-md-3 control-label">下单时间：</label>
                                                <div class="col-md-9">
                                                    <div class="input-group input-daterange date datepicker">
                                                        <input type="text" class="form-control" id="beginTime">
                                                        <div class="input-group-addon">
                                                            <span class="glyphicon glyphicon-th"></span>
                                                        </div>
                                                        <span class="input-group-addon">到</span>
                                                        <input type="text" class="form-control" id="endTime">
                                                        <div class="input-group-addon">
                                                            <span class="glyphicon glyphicon-th "></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row ng-scope">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="col-md-3 control-label">订单状态：</label>
                                                <div class="col-md-9">
                                                    <product-display-category class="ng-isolate-scope">
                                                        <div class="row">
                                                            <div class="col-md-3">
                                                                <select class="form-control"
                                                                        onchange="changestate()"
                                                                        id="orderstate">
                                                                    <option>
                                                                        请选择
                                                                    </option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </product-display-category>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="col-md-3 control-label">单据金额：</label>
                                                <div class="col-md-9">
                                                    <div class="input-group input-daterange">
                                                        <input class="form-control" type="number"
                                                               id="beginmoney" disabled="disabled"> <span
                                                            class="input-group-addon">到</span>
                                                        <input class="form-control " type="number" id="endmoney"
                                                               disabled="disabled">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                </div>
                                <div class="form-actions">
                                    <div class="row">
                                        <div class="col-md-7 col-md-offset-5">
                                            <button type="button" class="btn btn-primary"
                                                    onclick="searchClickOrder(1,1)"> 查询
                                            </button>
                                            <button type="button" class="btn btn-default"
                                                    onclick="resetClickOrder()">清空
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </form>

                            <div class="table-container ng-scope" ng-init="findList()">
                                <table class="table table-bordered table-hover table-striped " id="datatable_ajax">
                                    <thead>
                                    <tr class="heading">
                                        <th>序号</th>
                                        <th>订单编号</th>
                                        <th>订单状态</th>
                                        <th>订单备注</th>
                                        <th>订单创建人</th>
                                        <th>订单创建时间</th>
                                        <th>操作</th>
                                    </tr>
                                    </thead>
                                    <tbody id="selectOrderBody">

                                    </tbody>
                                </table>
                            </div>
                            <h5 class="ng-binding ng-scope" id="fanye"></h5>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
<script type="text/javascript">
    var data = ['请选择', '待确认', '待出库 ', '已出库', '已完成'];
    function bodyonloadOrder(obj) {
        var str = "";
        for (var i = 0; i < data.length; i++) {
            str += "<option>" + data[i] + "</option> ";
        }
        $("#orderstate").html(str);
        searchClickOrder(1, 1);
    }
    function changestate() {
        if ($("#orderstate").val() == "已完成") {
            $("#beginmoney").attr("disabled", false); //设置变灰按钮
            $("#endmoney").attr("disabled", false); //设置变灰按钮
        } else {
            $("#beginmoney").val("");
            $("#endmoney").val("");
            $("#beginmoney").attr("disabled", true); //设置变灰按钮
            $("#endmoney").attr("disabled", true); //设置变灰按钮
        }
    }
    function searchClickOrder(pageNum, pages) {
        var noteno = $("#noteno").val();
        var beginTime = formatTime($("#beginTime").val(), 1);
        var endTime = formatTime($("#endTime").val(), 2);
        var orderstate = $("#orderstate").val();
        var beginmoney = $("#beginmoney").val();
        var endmoney = $("#endmoney").val();
        if (orderstate == "请选择") {
            orderstate = null;
        }
        if (pageNum <= 0 || pageNum > pages) {
            return;
        }
        $.ajax({
            type: "POST",      //传输方式
            url: "../../selectOrder",
            dataType: 'json',
            contentType: 'application/json',
            data: JSON.stringify({            //传递的参数
                "noteno": noteno,
                "beginTime": beginTime,
                "endTime": endTime,
                "orderState": orderstate,
                "beginMoney": beginmoney,
                "endMoney": endmoney,
                "page": {
                    "pageNum": pageNum,
                    "pageSize": 20,
                    "orderBy": "asc"
                }
            }),
            success: function (obj) {
                if (obj.success == true) {
                    var str = "";
                    for (var i = 0; i < obj.data.length; i++) {
                        var data = obj.data[i];
                        var stateString = getStateColor(data.state);
                        str += "<tr class='odd gradeX ng-scope' >\n" +
                            " <td class='ng-binding'>" + (i + 1 + (obj.page.pageNum - 1) * obj.page.pageSize) + "</td>\n" +
                            " <td class='ng-binding'>" + data.noteno + "</td>" +
                            " <td>" + stateString + "</td>\n" +
                            "<td>" + data.remork + "</td>" +
                            "<td>" + data.createUser + "</td>" +
                            "<td >" + formationDate(new Date(data.createTime)) + "</td>" +
                            "<td ng-bind='item.des' class='ng-binding'>" + "操作" + "</td>" +
                            "</tr>"
                    }

                    $("#selectOrderBody").html(str);
                }
            },
            error: function (data, type, err) {
                $("#modelMsg").html(+data.responseJSON.status + ":" + data.responseJSON.message);
                $('#myModal').modal();
            }
        });
    }
    function resetClickOrder() {
        $("#noteno").val("");
        $("#beginTime").val("");
        $("#endTime").val("");
        var str = "";
        for (var i = 0; i < data.length; i++) {
            str += "<option>" + data[i] + "</option> ";
        }
        $("#orderstate").html(str);
        $("#beginmoney").val("");
        $("#endmoney").val("");
    }
    //根据不同的状态获得不同的标签颜色
    function getStateColor(state) {
        var str = ""
        if (state == "待确认") {
            str = "<span class='label label-sm label-warning'>待确认</span>"
        }
        if (state == "待出库") {
            str = "<span class='label label-sm label-danger'>待出库</span>"
        }
        if (state == "已出库") {
            str = "<span class='label label-sm label-primary'>已出库</span>"
        }
        if (state == "已完成") {
            str = "<span class='label label-sm label-success'>已完成</span>"
        }
        return str;
    }
    //格式化时间戳
    function formationDate(datetime) {
        var month = datetime.getMonth();
        var day = datetime.getDay();
        if (month >= 1 && month <= 9) {
            month = "0" + month;
        }
        if (day >= 0 && day <= 9) {
            day = "0" + day;
        }
        return datetime.getFullYear() + "-" + month + "-" + day + "&nbsp;" + datetime.getHours() + ":" + datetime.getMinutes() + ":" + datetime.getSeconds();
    }
    //格式化日期
    function formatTime(obj, i) {
        if (obj == null) {
            return null;
        }
        if (i == 1) {
            var str = obj.replace('年', '-').replace('月', '-').replace('日', 'T00:00:00.000+0800');
            return str;
        }
        var str = obj.replace('年', '-').replace('月', '-').replace('日', 'T23:59:59.999+0800');
        return str;
    }
</script>
<!--时间插件-->
<script>window.jQuery || document.write('<script src="../../js/jquery.min.js"><\/script>')</script>
<script src="../../js/bootstrap.min.css"></script>
<script src="../../js/bootstrap.min.js"></script>
<script src="../../js/jquery.min.js"></script>
<script src="../../js/bootstrap.min.js"></script>
<script src="../../js/bootstrap-datepicker.min.js"></script>
<script src="../../js/bootstrap-datepicker.zh-CN.min.js" charset="UTF-8"></script>
<script type="text/javascript">
    $(function () {
        $('.datepicker').datepicker({
            language: 'zh-CN'
        });
    })
</script>


//错误提示模态
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">错误提示!</h4>
            </div>
            <div class="modal-body" id="modelMsg" style="color: red">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>

</body>
</html>